{"componentChunkName":"component---src-templates-zh-docs-js","path":"/zh/workspace-extension","result":{"data":{"markdownRemark":{"html":"<p class=\"sub-title\">本页为Last-Hit工作空间扩展详细说明。</p>\n<h1 id=\"概念\"><a href=\"#%E6%A6%82%E5%BF%B5\" aria-label=\"概念 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概念</h1>\n<p>某些时候因为某些原因，仅仅依靠录制的数据无法进行正确的回放，例如重复校验、数据检查、不同的环境使用不同的账号等。<br>\n工作空间扩展正是为了解决此类场景而设计，为扩展Flow和Step在某些复杂场景下的适应能力，提供强大而动态的扩展方式。</p>\n<h1 id=\"extension-points\"><a href=\"#extension-points\" aria-label=\"extension points permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Extension Points</h1>\n<p>总共有7个扩展点，</p>\n<ul>\n<li><code class=\"language-text\">Environment Prepare</code>：环境准备</li>\n<li><code class=\"language-text\">Story Prepare</code>：Story准备</li>\n<li><code class=\"language-text\">Flow Should Start</code>：Flow即将开始</li>\n<li><code class=\"language-text\">Step Should Start</code>：Step即将开始</li>\n<li><code class=\"language-text\">Step On Error</code>：Step发生错误</li>\n<li><code class=\"language-text\">Step Accomplished</code>：Step结束</li>\n<li><code class=\"language-text\">Flow Accomplished</code>：Flow结束</li>\n</ul>\n<blockquote>\n<p><strong>以下名称仍然使用英文以便与代码进行对应。</strong>  </p>\n</blockquote>\n<h1 id=\"准备\"><a href=\"#%E5%87%86%E5%A4%87\" aria-label=\"准备 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>准备</h1>\n<h2 id=\"创建工作空间扩展包\"><a href=\"#%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E5%8C%85\" aria-label=\"创建工作空间扩展包 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>创建工作空间扩展包</h2>\n<ul>\n<li>找到您需要扩展的工作空间目录</li>\n<li>在工作空间根目录下创建扩展目录<code class=\"language-text\">workspace-folder/.scripts</code></li>\n<li>\n<p>初始化为一个NPM包</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> init</code></pre></div>\n<blockquote>\n<p>在package.json中设置包名称与您的工作空间名称相同，本例使用<code class=\"language-text\">a-demo</code>。</p>\n</blockquote>\n</li>\n</ul>\n<p>工作空间扩展包的结构与标准NPM包完全相同。</p>\n<h2 id=\"添加typescript支持\"><a href=\"#%E6%B7%BB%E5%8A%A0typescript%E6%94%AF%E6%8C%81\" aria-label=\"添加typescript支持 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>添加TypeScript支持</h2>\n<p>Typescript是可选的。  </p>\n<ul>\n<li>\n<p>安装TypeScript</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> typescript</code></pre></div>\n</li>\n<li>\n<p>创建TypeScript配置文件<code class=\"language-text\">tsconfig.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber 0\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es5\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"emitDecoratorMetadata\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"experimentalDecorators\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"removeComments\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"suppressImplicitAnyIndexErrors\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"resolveJsonModule\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist\"</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"node_modules\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>更新<code class=\"language-text\">package.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber 0\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/index.js\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token property\">\"compile\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tsc\"</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>我们推荐Typescript，并且本文档中所有示例均使用Typescript进行书写。</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"添加断言（assertion）包\"><a href=\"#%E6%B7%BB%E5%8A%A0%E6%96%AD%E8%A8%80%EF%BC%88assertion%EF%BC%89%E5%8C%85\" aria-label=\"添加断言（assertion）包 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>添加断言（Assertion）包</h2>\n<p>我们使用<code class=\"language-text\">expect.js</code>作为断言包，您可以使用您最喜欢的。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> expect.js @types/expect.js</code></pre></div>\n<h2 id=\"添加依赖包\"><a href=\"#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96%E5%8C%85\" aria-label=\"添加依赖包 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>添加依赖包</h2>\n<p>必要的依赖只有一个。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> last-hit-workspace-extension</code></pre></div>\n<h1 id=\"使用扩展点\"><a href=\"#%E4%BD%BF%E7%94%A8%E6%89%A9%E5%B1%95%E7%82%B9\" aria-label=\"使用扩展点 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用扩展点</h1>\n<p>我们建议使用约定名称进行扩展，您也可以按照接口定义创建您自己的。</p>\n<h2 id=\"定义入口\"><a href=\"#%E5%AE%9A%E4%B9%89%E5%85%A5%E5%8F%A3\" aria-label=\"定义入口 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>定义入口</h2>\n<p>这是工作空间扩展的入口，需要首先定义扩展文件的位置。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/index.ts</code>。<br>\n按照接口定义实现，并返回扩展文件位置。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AbstractWorkspaceExtensionEntryPoint <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-workspace-extension'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">WorkspaceExtensionEntryPoint</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractWorkspaceExtensionEntryPoint</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">getHandlerLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> __dirname<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WorkspaceExtensionEntryPoint</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"environment-prepare\"><a href=\"#environment-prepare\" aria-label=\"environment prepare permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Environment Prepare</h2>\n<p>此扩展点可以更新环境设置。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/env-pepare.ts</code>。<br>\n更改<code class=\"language-text\">sleepAfterChange</code>为30毫秒，<code class=\"language-text\">slowAjaxTime</code>为300毫秒。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>EnvironmentPrepareEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerTestHelper\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>PreparedEnvironment<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> env <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\n\tenv<span class=\"token punctuation\">.</span>sleepAfterChange <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n\tenv<span class=\"token punctuation\">.</span>slowAjaxTime <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> env<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>此时浏览器未打开。</p>\n</blockquote>\n<h2 id=\"story-prepare\"><a href=\"#story-prepare\" aria-label=\"story prepare permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Story Prepare</h2>\n<p>此扩展点准备Story参数。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/story-prepare.ts</code>。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>StoryPrepareEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerTestHelper\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>PreparedStory<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">log from extension, get story prepare of story[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>event<span class=\"token punctuation\">.</span>story<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> event<span class=\"token punctuation\">.</span>story<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>是Story的名称。</p>\n</blockquote>\n<blockquote>\n<p>浏览器此时未打开。</p>\n</blockquote>\n<blockquote>\n<p>此扩展点为预留扩展点，目前不能修改任何定义值。</p>\n</blockquote>\n<h2 id=\"flow-should-start\"><a href=\"#flow-should-start\" aria-label=\"flow should start permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flow Should Start</h2>\n<p>此扩展点可修改Flow参数值。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/my-first-flow/flow-should-start.ts</code>。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>FlowShouldStartEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerHelpers\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>PreparedFlow<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> story<span class=\"token punctuation\">,</span> flow <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> flow<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">(</span>params <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">param</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> param<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">,</span> param<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">(</span>flow <span class=\"token keyword\">as</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>PreparedFlow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\t\tinput<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n\t\t\tkey<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> flow<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>从<code class=\"language-text\">flow.params</code>中获取预定义的参数和值</li>\n<li>预定义的参数值可能是<code class=\"language-text\">undefined</code></li>\n<li>\n<p>每一个参数都会有三个属性：  </p>\n<ul>\n<li><code class=\"language-text\">name</code>：参数名称  </li>\n<li><code class=\"language-text\">type</code>：<code class=\"language-text\">in</code>，<code class=\"language-text\">out</code>和<code class=\"language-text\">both</code> （输入，输出和两者）<br>\n<code class=\"language-text\">both</code>代表这个参数在输入和输出都会被使用  </li>\n<li><code class=\"language-text\">value</code>：参数的默认值，通常如果没有设置过的情况下为空字符串</li>\n</ul>\n</li>\n<li>如果不需要做任何动作则直接将参数中的flow对象返回</li>\n<li>如果没有给出参数值，回放器会使用预定义参数的值</li>\n<li>\n<p>将您需要返回的参数放在<code class=\"language-text\">flow._.input</code>, 他是一个对象</p>\n<ul>\n<li><code class=\"language-text\">key</code>：参数名称</li>\n<li><code class=\"language-text\">value</code>：参数值</li>\n<li>这里不需要类型</li>\n<li>如果返回值，则预定义参数会被全部忽略</li>\n</ul>\n</li>\n</ul>\n<p>在以上示例代码中，无论预定义参数为何，都只有一个参数<code class=\"language-text\">key: &#39;value&#39;</code>被返回。<br>\n返回的参数与值可以在没有预定义的情况下使用。</p>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>为Story名称。<br>\n<code class=\"language-text\">my-first-flow</code>为Flow名称。</p>\n</blockquote>\n<blockquote>\n<p>浏览器此时未打开。</p>\n</blockquote>\n<h2 id=\"step-should-start\"><a href=\"#step-should-start\" aria-label=\"step should start permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step Should Start</h2>\n<p>此扩展点可以更新Step属性。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/my-first-flow/f6067c5d-f94d-4275-8263-1f33737b1b42/step-should-start.ts</code>.  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>StepShouldStartEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerHelpers\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>PreparedStep<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> story<span class=\"token punctuation\">,</span> flow<span class=\"token punctuation\">,</span> step <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> browser<span class=\"token punctuation\">:</span> browserHelper <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> helpers<span class=\"token punctuation\">;</span>\n\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">log from extension, get step should start of story[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>story<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">], flow[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>flow<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">], step[index=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>step<span class=\"token punctuation\">.</span>stepIndex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, stepUuid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>step<span class=\"token punctuation\">.</span>stepUuid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browserHelper<span class=\"token punctuation\">.</span><span class=\"token function\">getElementAttrValue</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token string\">'#some-id'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string\">'47792ef4-3a1e-4d27-9707-abc6fb77bb8b'</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value from browser operation'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> step<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>从<code class=\"language-text\">flow.params</code>获取Flow参数, 此时只能获取输入参数</li>\n<li>可以更改step的属性值，并且返回给回放器</li>\n<li><code class=\"language-text\">47792ef4-3a1e-4d27-9707-abc6fb77bb8b</code>是全局唯一的页面UUID. 可以从Step的<code class=\"language-text\">uuid</code>上获取</li>\n</ul>\n<p>在这个示例中，尝试获取页面中id为<code class=\"language-text\">some-id</code>的DOM节点的name属性值。</p>\n<blockquote>\n<p><strong>不要</strong>改动固定属性的值，例如<code class=\"language-text\">uuid</code>、<code class=\"language-text\">type</code>、<code class=\"language-text\">stepUuid</code>、<code class=\"language-text\">stepIndex</code>等。</p>\n</blockquote>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>是Story名称。<br>\n<code class=\"language-text\">my-first-flow</code>是Flow名称。<br>\n<code class=\"language-text\">f6067c5d-f94d-4275-8263-1f33737b1b42</code>是全局唯一的Step UUID，可以从Step的<code class=\"language-text\">stepUuid</code>属性上获取。</p>\n</blockquote>\n<blockquote>\n<p>如果Step是Start Step（开始Step，第一步），浏览器此时未打开。<br>\n如果是其他Step，浏览器此时已打开。</p>\n</blockquote>\n<h2 id=\"step-on-error\"><a href=\"#step-on-error\" aria-label=\"step on error permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step On Error</h2>\n<p>此扩展点主动捕捉到Step回放中的错误，可以选择修复（忽略错误）或者忽略（仍然报错）。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/my-first-flow/f6067c5d-f94d-4275-8263-1f33737b1b42/step-on-error.ts</code>。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>StepOnErrorEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerHelpers\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>FixedStep<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> story<span class=\"token punctuation\">,</span> flow<span class=\"token punctuation\">,</span> step<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> browser<span class=\"token punctuation\">:</span> browserHelper <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> helpers<span class=\"token punctuation\">;</span>\n\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>step<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> fixed<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>回放器在遇到Step回放出错时，默认行为是报错并停止回放。在这里示例中，错误被扩展点主动捕捉（主动捕捉无需代码，为引擎行为）并选择修复。因此回放器在获取到修复信号之后，继续进行回放。如果不需要修复错误，则将参数Step直接返回即可。</p>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>是Story名称。<br>\n<code class=\"language-text\">my-first-flow</code>是Flow名称。<br>\n<code class=\"language-text\">f6067c5d-f94d-4275-8263-1f33737b1b42</code>是全局唯一的Step UUID，可以从Step的<code class=\"language-text\">stepUuid</code>属性上获取。</p>\n</blockquote>\n<blockquote>\n<p>在Start Step（开始Step，第一步）出现错误，不会触发本扩展点逻辑。</p>\n</blockquote>\n<blockquote>\n<p>浏览器此时已打开。</p>\n</blockquote>\n<h2 id=\"step-accomplished\"><a href=\"#step-accomplished\" aria-label=\"step accomplished permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step Accomplished</h2>\n<p>此扩展点通常进行断言。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/my-first-flow/f6067c5d-f94d-4275-8263-1f33737b1b42/step-accomplished.ts</code>。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> expect <span class=\"token keyword\">from</span> <span class=\"token string\">'expect.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>StepAccomplishedEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerHelpers\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>AccomplishedStep<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> story<span class=\"token punctuation\">,</span> flow<span class=\"token punctuation\">,</span> step <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> browser<span class=\"token punctuation\">:</span> browserHelper<span class=\"token punctuation\">,</span> test<span class=\"token punctuation\">:</span> testHelper <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> helpers<span class=\"token punctuation\">;</span>\n\t<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">log from extension, get step accomplished of story[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>story<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">], flow[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>flow<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">], step[index=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>step<span class=\"token punctuation\">.</span>stepIndex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, stepUuid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>step<span class=\"token punctuation\">.</span>stepUuid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">await</span> testHelper<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token string\">'check name of element[#some-id] is [some-attr-value]'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browserHelper<span class=\"token punctuation\">.</span><span class=\"token function\">getElementAttrValue</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token string\">'#some-id'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t<span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t<span class=\"token string\">'47792ef4-3a1e-4d27-9707-abc6fb77bb8b'</span>\n\t\t\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">be</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-attr-value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">await</span> testHelper<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token string\">'check value of element[#some-id]'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">await</span> testHelper<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token string\">'should be 你好'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t<span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browserHelper<span class=\"token punctuation\">.</span><span class=\"token function\">getElementPropValue</span><span class=\"token punctuation\">(</span>\n\t\t\t\t\t\t<span class=\"token string\">'#some-id'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t<span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t<span class=\"token string\">'47792ef4-3a1e-4d27-9707-abc6fb77bb8b'</span>\n\t\t\t\t\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">be</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-prop-value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>step<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> passed<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>使用您最熟悉的第三方书写断言</li>\n<li>如果断言失败，请抛出错误（通常断言库包含此功能）</li>\n<li><code class=\"language-text\">Test Helper</code>会主动捕获断言异常</li>\n<li>任何断言成功或者失败都会被回放器搜集</li>\n<li>断言异常不会再触发<code class=\"language-text\">Step On Error</code>扩展点</li>\n</ul>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>是Story名称。<br>\n<code class=\"language-text\">my-first-flow</code>是Flow名称。<br>\n<code class=\"language-text\">f6067c5d-f94d-4275-8263-1f33737b1b42</code>是全局唯一的Step UUID，可以从Step的<code class=\"language-text\">stepUuid</code>属性上获取。</p>\n</blockquote>\n<blockquote>\n<p>浏览器此时已打开。</p>\n</blockquote>\n<h2 id=\"flow-accomplished\"><a href=\"#flow-accomplished\" aria-label=\"flow accomplished permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flow Accomplished</h2>\n<p>此扩展点可以构造Flow输出参数。</p>\n<p>创建文件<code class=\"language-text\">workspace-folder/.scripts/my-first-story/my-first-flow/flow-accomplished.ts</code>。  </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WorkspaceExtensions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'last-hit-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n\tevent<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>FlowAccomplishedEvent<span class=\"token punctuation\">,</span>\n\thelpers<span class=\"token punctuation\">:</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>HandlerHelpers\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>WorkspaceExtensions<span class=\"token punctuation\">.</span>AccomplishedFlow<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> story<span class=\"token punctuation\">,</span> flow <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token punctuation\">(</span>flow <span class=\"token keyword\">as</span> WorkspaceExtensions<span class=\"token punctuation\">.</span>AccomplishedFlow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\t\toutput<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n\t\t\tkey<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> flow<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>从<code class=\"language-text\">flow.params</code>获取预定义和输入参数实例</li>\n<li>\n<p>每一个参数都有三个属性：</p>\n<ul>\n<li><code class=\"language-text\">name</code>: 参数名称</li>\n<li><code class=\"language-text\">type</code>: <code class=\"language-text\">in</code>, <code class=\"language-text\">out</code> and <code class=\"language-text\">both</code>（输入，输出和两者）<br>\n<code class=\"language-text\">both</code>代表这个参数在输入和输出都会被使用  </li>\n<li><code class=\"language-text\">value</code>：参数的默认值，通常如果没有设置过的情况下为空字符串  </li>\n</ul>\n</li>\n<li>如果没有输出参数需要定义，直接返回参数中的Flow对象即可</li>\n<li>如果没有指定输出参数值，则回放器使用预定义的输出参数值</li>\n<li>\n<p>将您需要返回的参数放在<code class=\"language-text\">flow._.output</code>，他是一个对象</p>\n<ul>\n<li><code class=\"language-text\">key</code>: 参数名称</li>\n<li><code class=\"language-text\">value</code>: 参数值</li>\n<li>这里不需要类型</li>\n<li>如果返回值，则预定义参数会被全部忽略</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p><code class=\"language-text\">my-first-story</code>是Story名称。<br>\n<code class=\"language-text\">my-first-flow</code>是Flow名称。  </p>\n</blockquote>\n<blockquote>\n<p>输出的参数值在IDE会将会被忽略。</p>\n</blockquote>\n<blockquote>\n<p>浏览器此时已打开。</p>\n</blockquote>\n<h1 id=\"编译工作空间扩展包\"><a href=\"#%E7%BC%96%E8%AF%91%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E5%8C%85\" aria-label=\"编译工作空间扩展包 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>编译工作空间扩展包</h1>\n<p>编译工作空间扩展包的方法与编译标准Typescript包完全一致。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> run compile</code></pre></div>\n<blockquote>\n<p>时刻保证您的工作空间扩展包处于已编译状态。IDE和CI都不会主动编译您的工作空间扩展包。<br>\nES5或者任何NodeJS支持的语法都可以正常工作。</p>\n</blockquote>\n<h1 id=\"在工作空间扩展中维持数据\"><a href=\"#%E5%9C%A8%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E4%B8%AD%E7%BB%B4%E6%8C%81%E6%95%B0%E6%8D%AE\" aria-label=\"在工作空间扩展中维持数据 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>在工作空间扩展中维持数据</h1>\n<p>您可以在工作空间扩展中维持缓存数据，数据可以在Step间共享访问。</p>\n<blockquote>\n<p><strong>不要</strong>试图在Story或者Flow之间共享数据。工作空间扩展会使用扩展重载技术保证数据无法采用此类共享方式，以便杜绝数据互相影响。如果需要在Flow之间传递数据，请使用Flow输入输出参数。</p>\n</blockquote>\n<h1 id=\"断言结果搜集\"><a href=\"#%E6%96%AD%E8%A8%80%E7%BB%93%E6%9E%9C%E6%90%9C%E9%9B%86\" aria-label=\"断言结果搜集 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>断言结果搜集</h1>\n<p>断言异常将被自动搜集。如果您主动捕获断言异常，并且没有抛出其他异常，<code class=\"language-text\">Test Helper</code>将会忽略断言失败并认为该断言成功执行。</p>\n<h1 id=\"helpers\"><a href=\"#helpers\" aria-label=\"helpers permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helpers</h1>\n<h2 id=\"浏览器helper\"><a href=\"#%E6%B5%8F%E8%A7%88%E5%99%A8helper\" aria-label=\"浏览器helper permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>浏览器Helper</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> browser<span class=\"token punctuation\">:</span> browserHelper <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> helpers<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<blockquote>\n<p>如果扩展点当时浏览器尚未打开，则浏览器Helper不会被作为参数预置。</p>\n</blockquote>\n<p>浏览器Helper提供的API如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">IWorkspaceExtensionBrowserHelper</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">getElementAttrValue</span><span class=\"token punctuation\">(</span>\n\t\tcsspath<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n\t\tattrName<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n\t\tpageUuid<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">getElementPropValue</span><span class=\"token punctuation\">(</span>\n\t\tcsspath<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n\t\tpropName<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n\t\tpageUuid<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">isInIDE</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>如果<code class=\"language-text\">pageUuid</code>没有指定，则从第一个页面中查找。</p>\n</blockquote>\n<h2 id=\"测试helper\"><a href=\"#%E6%B5%8B%E8%AF%95helper\" aria-label=\"测试helper permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>测试Helper</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> test<span class=\"token punctuation\">:</span> testHelper <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> helpers<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>测试Helper仅提供一个方法如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">IWorkspaceExtensionTestHelper</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">test</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token function-variable function\">fn</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">this</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>","tableOfContents":"<ul>\n<li><a href=\"/zh/workspace-extension/#%E6%A6%82%E5%BF%B5\">概念</a></li>\n<li><a href=\"/zh/workspace-extension/#extension-points\">Extension Points</a></li>\n<li>\n<p><a href=\"/zh/workspace-extension/#%E5%87%86%E5%A4%87\">准备</a></p>\n<ul>\n<li><a href=\"/zh/workspace-extension/#%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E5%8C%85\">创建工作空间扩展包</a></li>\n<li><a href=\"/zh/workspace-extension/#%E6%B7%BB%E5%8A%A0typescript%E6%94%AF%E6%8C%81\">添加TypeScript支持</a></li>\n<li><a href=\"/zh/workspace-extension/#%E6%B7%BB%E5%8A%A0%E6%96%AD%E8%A8%80%EF%BC%88assertion%EF%BC%89%E5%8C%85\">添加断言（Assertion）包</a></li>\n<li><a href=\"/zh/workspace-extension/#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96%E5%8C%85\">添加依赖包</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/zh/workspace-extension/#%E4%BD%BF%E7%94%A8%E6%89%A9%E5%B1%95%E7%82%B9\">使用扩展点</a></p>\n<ul>\n<li><a href=\"/zh/workspace-extension/#%E5%AE%9A%E4%B9%89%E5%85%A5%E5%8F%A3\">定义入口</a></li>\n<li><a href=\"/zh/workspace-extension/#environment-prepare\">Environment Prepare</a></li>\n<li><a href=\"/zh/workspace-extension/#story-prepare\">Story Prepare</a></li>\n<li><a href=\"/zh/workspace-extension/#flow-should-start\">Flow Should Start</a></li>\n<li><a href=\"/zh/workspace-extension/#step-should-start\">Step Should Start</a></li>\n<li><a href=\"/zh/workspace-extension/#step-on-error\">Step On Error</a></li>\n<li><a href=\"/zh/workspace-extension/#step-accomplished\">Step Accomplished</a></li>\n<li><a href=\"/zh/workspace-extension/#flow-accomplished\">Flow Accomplished</a></li>\n</ul>\n</li>\n<li><a href=\"/zh/workspace-extension/#%E7%BC%96%E8%AF%91%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E5%8C%85\">编译工作空间扩展包</a></li>\n<li><a href=\"/zh/workspace-extension/#%E5%9C%A8%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E6%89%A9%E5%B1%95%E4%B8%AD%E7%BB%B4%E6%8C%81%E6%95%B0%E6%8D%AE\">在工作空间扩展中维持数据</a></li>\n<li><a href=\"/zh/workspace-extension/#%E6%96%AD%E8%A8%80%E7%BB%93%E6%9E%9C%E6%90%9C%E9%9B%86\">断言结果搜集</a></li>\n<li>\n<p><a href=\"/zh/workspace-extension/#helpers\">Helpers</a></p>\n<ul>\n<li><a href=\"/zh/workspace-extension/#%E6%B5%8F%E8%A7%88%E5%99%A8helper\">浏览器Helper</a></li>\n<li><a href=\"/zh/workspace-extension/#%E6%B5%8B%E8%AF%95helper\">测试Helper</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"date":"December 23, 2019","path":"/zh/workspace-extension","title":"工作空间扩展","author":"bradwoo8621"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}